<div class="post-list-container">
  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading posts...</p>
    </div>
  }

  <!-- Error State -->
  @else if (error()) {
    <div class="error-container">
      <h3 class="error-title">Oops! Something went wrong</h3>
      <p class="error-message">{{ error() }}</p>
      <button class="retry-button" (click)="onRetry()">
        Try Again
      </button>
    </div>
  }

  <!-- Posts List -->
  @else {
    <div class="posts-content">
      <!-- Search Box -->
      <app-search-box (searchChange)="onSearchChange($event)"></app-search-box>

      <!-- Pagination Info -->
      <div class="pagination-info">
        <p>
          Showing {{ paginationInfo().startItem }} to {{ paginationInfo().endItem }}
          of {{ paginationInfo().totalItems }} posts
        </p>
      </div>

      <!-- Posts Grid -->
      <div class="posts-grid">
        @for (post of posts(); track trackByPostId($index, post)) {
          <app-post-card
            [post]="post"
            (postClick)="onPostClick($event)">
          </app-post-card>
        } @empty {
          <div class="empty-state">
            <h3>No posts found</h3>
            <p>Try adjusting your search or check back later.</p>
          </div>
        }
      </div>

      <!-- Pagination Controls -->
      @if (paginationInfo().totalPages > 1) {
        <div class="pagination-controls">
          <button
            class="pagination-btn"
            [disabled]="!paginationInfo().hasPrevious"
            (click)="onPreviousPage()">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m15 18-6-6 6-6"/>
            </svg>
            <span class="sr-only">Previous</span>
          </button>

          <div class="page-numbers">
            @for (page of getPageNumbers(); track page) {
              <button
                class="page-btn"
                [class.active]="page === paginationInfo().currentPage"
                (click)="onGoToPage(page)">
                {{ page }}
              </button>
            }
          </div>

          <button
            class="pagination-btn"
            [disabled]="!paginationInfo().hasNext"
            (click)="onNextPage()">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6"/>
            </svg>
            <span class="sr-only">Next</span>
          </button>
        </div>
      }
    </div>
  }

  <!-- Post Detail Modal -->
  @if (selectedPost()) {
    <app-modal
      [isOpen]="isModalOpen()"
      [title]="selectedPost()!.title"
      size="large"
      (closeModal)="onCloseModal()">
      <app-post-detail [post]="selectedPost()!"></app-post-detail>
    </app-modal>
  }
</div>
